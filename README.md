# Общая архитектура проекта

Общая архитектура проекта базируется на модифицированном паттерне MVC. Ниже представлена общая структура проекта и связи между ее частями.

![GeneralArchitecture](https://github.com/dezhurko/faraway-platformer/assets/7524653/6dbe3220-bdf0-489d-81a1-7db9d8c89df3)

*Рис 1. Диаграмма основных сборок в проекте.*

* Сборка Actors - аналог сборки View, представляет собой максимально лишенные логики классы, предоставляющие интерфейс взаимодействия с классами движка Unity.
* Сборка Actors.Contracts - сборка, содержащая интерфейсы, отделяющие классы сборки Actors от классов из сборки Controllers.
* Сборка Entities - это модель приложения. Здесь содержится вся бизнес-логика.
* Сборка Controllers - содержит классы контроллеров, связывающие модель и представление (Actors).

Эта архитектура позволяет реализовать абстрактную бизнес-логику и логику контроллеров независимо от деталей реализации представления.
Также эта структура позволяет покрыть юнит-тестами классы модели и контроллеры.
В проекте представлен пример написания юнит-тестов для классов FlyingBuff и SpeedBuff (сборка Entities.Test).

Создание объектов и их связывание выполняется в классе MainEntry. Это единая точка входа в проект. Для продакшн-проектов среднего или крупного размера рекомендуется использовать DI-фреймворк, подобный Zenject или VContainer.

При разработке логики приложения наибольший интерес вызвала разработка классов для реализации логики бафов и дебафов.
Ниже представлена диаграмма классов, которая обеспечивает простое добавление новых бафов и диаграмма классов для реализации логики интерактивных обектов на сцене.

![InteractiveObjects](https://github.com/dezhurko/faraway-platformer/assets/7524653/2e22d365-5815-4a3c-8230-65d108931759)

*Рис 2. Диаграмма классов для реализации логики интерактивных обектов на сцене.*

![InteractiveObjects](https://github.com/dezhurko/faraway-platformer/assets/7524653/8df9d9f2-b3f9-47b8-b7ac-c917102b4b41)

*Рис 3. Диаграмма классов описывающий принцип работы системы бафов и дебафов.*

Любой интерактивный объект (Actors.InteractiveObject) при взаимодействии вызывает событие с параметром объекта-наследника класса InteractiveObjectData. На основе этого объекта фабрика создает объект-наследник типа InteractiveObject.
Внутри метода Interact этого объекта можно описать любую логику взаимодействия. Для интерактивных объектов, содержащих бафы и дебафы, создается объект класса BuffInteractiveObject. Который, в свою очередь, тоже содержит фабрику для создания определенного бафа.
Все бафы имеют метод, определяющий правила комбинирования бафов, чтобы корректно накладывать и снимать несколько одинаковых бафов.
